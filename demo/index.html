<html>
	<head>
		<script type="module">
			import '@webcomponents/webcomponentsjs/webcomponents-loader.js';
			import '@polymer/iron-demo-helpers/demo-pages-shared-styles.js';
			import '@polymer/iron-demo-helpers/demo-snippet.js';
			import '@polymer/paper-input/paper-input';
			import '@fluidnext-polymer/paper-autocomplete/paper-autocomplete';
			import '@polymer/paper-checkbox';
			import '../paper-chips.js';
		</script>
		<custom-style>
				<style is="custom-style" include="demo-pages-shared-styles">
					body{
						font-family:roboto;
						--demo-snippet-code: {
							max-height: 300px;
							overflow: auto;
						}
					}
				</style>
		</custom-style>
	</head>

	<body>
		<style>
			.chipsContainer {
				height: 70px;
				overflow: auto;
			}
		</style>
		<div class="vertical-section-container centered">
			<h3>Paper Chip</h3>
				<demo-snippet>
					<template>
						<dom-bind id="simplePaperChip">
							<template>
								<paper-chip selectable="[[selectable]]">Apples</paper-chip>
								<paper-checkbox checked="{{selectable}}">Selectable</paper-checkbox>
							</template>
						</dom-bind>
					</template>
				</demo-snippet>
			<h3>Paper Chips accept strings</h3>
			<demo-snippet>
				<template>
					<dom-bind id="stringInputDemo">
						<template>
								<div class="chipsContainer">
									<paper-chips id="stringChips" items=[[fruits]] empty="{{empty}}" on-delete-item="onRemove"></paper-chips>
								</div>
								<paper-input id="fruitInputString" label="Enter a fruit name and press enter" on-keypress='sendInput'></paper-input>
						</template>
					</dom-bind>
					<script>
						document.addEventListener('DOMContentLoaded', (event) => {
							const domBindStringDemo = document.querySelector('dom-bind#stringInputDemo');
							domBindStringDemo.fruits = [
								"Apricot",
								"Wumpa",
								"Pear"
							];

							domBindStringDemo.sendInput = function(evt) {
								if(evt.code === 'Enter' && evt.target.value && evt.target.value != ''){
									domBindStringDemo.$.stringChips.add(evt.target.value);
									evt.target.value = null;
								}
							}

							domBindStringDemo.onRemove = function(e) {
								const item = e.detail.item[0];
								console.log(item + " deleted")
							}
						})
					</script>
				</template>
			</demo-snippet>

			<h3>Paper Chips accept objects and associated images</h3>
			<demo-snippet>
				<template>
					<style>
						paper-autocomplete#fruitInputObjects {
							--paper-autocomplete-main-color: #37BF00;
						}
					</style>
					<dom-bind id="objectInputDemo">
						<template>
							<div class="chipsContainer">
								<paper-chips id="objectChips" items="[[defaultItems]]" text-property="name" image-property="preview" empty="{{empty}}" on-delete-item="onRemove"></paper-chips>
							</div>
							<paper-autocomplete id="fruitInputObjects" show-results-on-focus="true" label="Click me to select a Fruit" text-property="name" on-autocomplete-selected="addSelected">
								<template id="customTemplate" slot="autocomplete-custom-template">
									<style>
										:host {
											--suggestions-item-min-height: 100px;
										}

										.container{
											display: flex;
											flex-direction: column;
										}
				
										.info{
											padding: 2px;
											width: 100%;
										}
				
										.info > div{
											padding-left: 4px;
										}
				
										.fruit-name {
											color: #2F4858;
										}
				
										.fruit-id, .fruit-color{
											margin-top: 4px;
											color: #007C86;
										}
									</style>
									<paper-item class="custom-item" on-tap="_onSelect" id$="[[_getSuggestionId(index)]]" role="option" aria-selected="false">
										<div class="container info" index="[[index]]">
											<div class="fruit-id">ID: [[item.id]]</div>
											<div class="fruit-name">Name: [[item.name]]</div>
											<div class="fruit-color">Color: [[item.color]]</div>
										</div>
										<paper-ripple></paper-ripple>
									</paper-item>
								</template>
							</paper-autocomplete>
						</template>
					</dom-bind>

					<script>
						document.addEventListener('DOMContentLoaded', (event) => {
							const domBindObjectDemo = document.querySelector('dom-bind#objectInputDemo');

							domBindObjectDemo.fruits = [
								{ id: 'apples', name: 'Apples', color: 'Red', preview: "apple.jpg"},
								{ id: 'Bananas', name: 'Bananas', color: 'Yellow', preview: "banana.jpg"},
								{ id: 'pineapple', name: 'Pineapple', color: 'Green', preview: "pineapple.jpg"},
								{ id: 'orange', name: 'Orange', color: 'Orange'}
							];

							domBindObjectDemo.defaultItems = [
								{ 
									[domBindObjectDemo.$.objectChips.textProperty]: domBindObjectDemo.fruits[0][domBindObjectDemo.$.objectChips.textProperty], 
									[domBindObjectDemo.$.objectChips.imageProperty]: domBindObjectDemo.fruits[0][domBindObjectDemo.$.objectChips.imageProperty]
								}
							];

							// setVariable for the fruitInputObjects example
							domBindObjectDemo.$.fruitInputObjects.source = domBindObjectDemo.fruits;

							domBindObjectDemo.addSelected = function(evt) {
								if(typeof(evt.detail.value) === 'object' && evt.detail.value != null){
									domBindObjectDemo.$.objectChips.add({ 
										[domBindObjectDemo.$.objectChips.textProperty]: evt.detail.value[domBindObjectDemo.$.objectChips.textProperty], 
										[domBindObjectDemo.$.objectChips.imageProperty]: evt.detail.value[domBindObjectDemo.$.objectChips.imageProperty]
									});

									setTimeout(function(){
										evt.target.clear();
									}, 500);
								}
							}

							domBindObjectDemo.onRemove = function(e) {
								const item = e.detail.item[0].name;
								console.log(item + " deleted")
							}
						})
					</script>
				</template>
			</demo-snippet>
		</div>
	</body>
</html>
